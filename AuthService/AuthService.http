@AuthService_HostAddress = http://localhost:5209
@GraphQL_Endpoint = {{AuthService_HostAddress}}/auth/graphql

###
# Health Check Endpoints
###

GET {{AuthService_HostAddress}}/auth/health
Accept: application/json

###

GET {{AuthService_HostAddress}}/auth/health/live
Accept: application/json

###

GET {{AuthService_HostAddress}}/auth/health/ready
Accept: application/json

###
# GraphQL Queries and Mutations
###

# Test GraphQL endpoint
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "query { hello(name: \"GraphQL\") }"
}

###

# Register a new user
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "mutation RegisterUser($input: RegisterRequestInput!) { registerUser(input: $input) { accessToken refreshToken expiresIn user { id email applicationCode } } }",
  "variables": {
    "input": {
      "email": "test@example.com",
      "password": "TestPassword123!",
      "confirmPassword": "TestPassword123!",
      "applicationCode": "testapp",
      "phoneNumber": "+1234567890"
    }
  }
}

###

# Login with registered user
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "mutation LoginUser($input: LoginRequestInput!) { loginUser(input: $input) { accessToken refreshToken expiresIn user { id email applicationCode } } }",
  "variables": {
    "input": {
      "email": "test@example.com",
      "password": "TestPassword123!",
      "applicationCode": "testapp"
    }
  }
}

###

# Get current user info (requires Authorization header)
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query { getCurrentUser { id email application { name code } isEmailVerified createdAt } }"
}

###

# Refresh access token
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "mutation RefreshToken($refreshToken: String!) { refreshToken(refreshToken: $refreshToken) { accessToken refreshToken expiresIn } }",
  "variables": {
    "refreshToken": "YOUR_REFRESH_TOKEN_HERE"
  }
}

###

# Logout user
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "mutation LogoutUser($refreshToken: String!) { logoutUser(refreshToken: $refreshToken) }",
  "variables": {
    "refreshToken": "YOUR_REFRESH_TOKEN_HERE"
  }
}

###
# Application Management (Admin)
###

# Get all applications
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query { getApplications { id name code isActive createdAt } }"
}

###

# Get specific application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetApplication($id: UUID!) { getApplicationById(id: $id) { id name code isActive createdAt } }",
  "variables": {
    "id": "YOUR_APP_ID_HERE"
  }
}

###

# Create new application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation CreateApplication($name: String!, $code: String!, $description: String) { createApplication(name: $name, code: $code, description: $description) { id name code isActive createdAt } }",
  "variables": {
    "name": "Test Application",
    "code": "testapp",
    "description": "A test application for development"
  }
}

###

# Update application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation UpdateApplication($id: UUID!, $name: String, $description: String, $isActive: Boolean) { updateApplication(id: $id, name: $name, description: $description, isActive: $isActive) { id name code isActive createdAt } }",
  "variables": {
    "id": "YOUR_APP_ID_HERE",
    "name": "Updated Test Application",
    "description": "Updated description",
    "isActive": true
  }
}

###

# Get application statistics
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetApplicationStats($applicationId: UUID!) { getApplicationStats(applicationId: $applicationId) { applicationId userCount apiKeyCount roleCount sessionCount } }",
  "variables": {
    "applicationId": "YOUR_APP_ID_HERE"
  }
}

###

# Delete application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation DeleteApplication($id: UUID!) { deleteApplication(id: $id) }",
  "variables": {
    "id": "YOUR_APP_ID_HERE"
  }
}

###
# User Management (Admin)
###

# Get users for application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetUsersByApplication($applicationId: UUID!) { getUsersByApplication(applicationId: $applicationId) { id email isEmailVerified isActive createdAt application { name } } }",
  "variables": {
    "applicationId": "YOUR_APP_ID_HERE"
  }
}

###

# Search users (using GraphQL filtering)
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetUsersByApplication($applicationId: UUID!) { getUsersByApplication(applicationId: $applicationId, where: { email: { contains: \"test\" } }) { id email isEmailVerified isActive createdAt } }",
  "variables": {
    "applicationId": "YOUR_APP_ID_HERE"
  }
}

###

# Get specific user
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetUser($id: UUID!) { getUserById(id: $id) { id email phoneNumber isEmailVerified isActive createdAt application { name code } } }",
  "variables": {
    "id": "YOUR_USER_ID_HERE"
  }
}

###

# Update user
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation UpdateUser($id: UUID!, $email: String, $phoneNumber: String, $isEmailVerified: Boolean, $isActive: Boolean) { updateUser(id: $id, email: $email, phoneNumber: $phoneNumber, isEmailVerified: $isEmailVerified, isActive: $isActive) { id email phoneNumber isEmailVerified isActive } }",
  "variables": {
    "id": "YOUR_USER_ID_HERE",
    "email": "updated@example.com",
    "phoneNumber": "+1987654321",
    "isEmailVerified": true,
    "isActive": true
  }
}

###

# Assign role to user
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation AssignRoleToUser($userId: UUID!, $roleId: UUID!) { assignRoleToUser(userId: $userId, roleId: $roleId) }",
  "variables": {
    "userId": "YOUR_USER_ID_HERE",
    "roleId": "ROLE_ID_HERE"
  }
}

###

# Remove role from user
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation RemoveRoleFromUser($userId: UUID!, $roleId: UUID!) { removeRoleFromUser(userId: $userId, roleId: $roleId) }",
  "variables": {
    "userId": "YOUR_USER_ID_HERE",
    "roleId": "ROLE_ID_HERE"
  }
}

###

# Get user roles
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetUserRoles($userId: UUID!) { getUserRoles(userId: $userId) { id name description } }",
  "variables": {
    "userId": "YOUR_USER_ID_HERE"
  }
}

###

# Get user sessions
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetUserSessions($userId: UUID!) { getUserSessionLogs(userId: $userId) { id loginAt logoutAt ipAddress userAgent isSuccessful } }",
  "variables": {
    "userId": "YOUR_USER_ID_HERE"
  }
}

###

# Delete user
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation DeleteUser($id: UUID!) { deleteUser(id: $id) }",
  "variables": {
    "id": "YOUR_USER_ID_HERE"
  }
}

###
# API Key Management
###

# Get API keys for application
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetApiKeysByApplication($applicationId: UUID!) { getApiKeysByApplication(applicationId: $applicationId) { id name scopes createdAt expiresAt isActive ownerUser { email } } }",
  "variables": {
    "applicationId": "YOUR_APP_ID_HERE"
  }
}

###

# Get specific API key
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "query GetApiKey($id: UUID!) { getApiKeyById(id: $id) { id name scopes createdAt expiresAt isActive ownerUser { email } application { name } } }",
  "variables": {
    "id": "YOUR_API_KEY_ID_HERE"
  }
}

###

# Create API key
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation CreateApiKey($applicationId: UUID!, $name: String!, $scopes: [String!], $expiresInDays: Int) { createApiKey(applicationId: $applicationId, name: $name, scopes: $scopes, expiresInDays: $expiresInDays) { id name apiKey scopes expiresAt createdAt } }",
  "variables": {
    "applicationId": "YOUR_APP_ID_HERE",
    "name": "Test API Key",
    "scopes": ["read", "write"],
    "expiresInDays": 30
  }
}

###

# Update API key
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation UpdateApiKey($id: UUID!, $name: String, $scopes: [String!]) { updateApiKey(id: $id, name: $name, scopes: $scopes) { id name scopes createdAt expiresAt isActive } }",
  "variables": {
    "id": "YOUR_API_KEY_ID_HERE",
    "name": "Updated API Key",
    "scopes": ["read"]
  }
}

###

# Revoke API key
POST {{GraphQL_Endpoint}}
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "query": "mutation RevokeApiKey($id: UUID!) { revokeApiKey(id: $id) }",
  "variables": {
    "id": "YOUR_API_KEY_ID_HERE"
  }
}

###
# API Key Validation (Internal)
###

# Validate API key
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "mutation ValidateApiKey($apiKey: String!, $requestedScope: String, $ipAddress: String) { validateApiKey(apiKey: $apiKey, requestedScope: $requestedScope, ipAddress: $ipAddress) { isValid message applicationId userId scopes } }",
  "variables": {
    "apiKey": "YOUR_API_KEY_HERE",
    "requestedScope": "read",
    "ipAddress": "127.0.0.1"
  }
}

###
# External OAuth Authentication
###
# Note: OAuth flows typically involve redirects and are not well-suited for GraphQL.
# OAuth authentication is still supported through traditional REST endpoints:
# POST /auth/external-login (initiate OAuth)
# GET /auth/external-callback/{provider} (OAuth callback)
# POST /auth/link-external-login (link OAuth account)
# POST /auth/unlink-external-login (unlink OAuth account)
# GET /auth/external-logins (get linked accounts)

# OAuth endpoints remain as REST API since they involve browser redirects

###

# GraphQL Schema Introspection
###

# Get GraphQL schema (for API documentation)
POST {{GraphQL_Endpoint}}
Content-Type: application/json

{
  "query": "query IntrospectionQuery { __schema { queryType { name } mutationType { name } types { ...FullType } directives { name description locations args { ...InputValue } } } } fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef } } fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue } fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } } }"
}

###

# GraphQL Playground (for browser-based testing)
# Open in browser: {{AuthService_HostAddress}}/graphql (when in development mode)
